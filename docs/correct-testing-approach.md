# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Red-Black Tree

## –ü—Ä–∏–Ω—Ü–∏–ø: Black-Box Testing

**–¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API, –∞ –Ω–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.**

## ‚ùå –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

```kotlin
// ‚ùå –ü–õ–û–•–û: –î–µ–ª–∞—Ç—å –º–µ—Ç–æ–¥—ã internal/public –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
class RedBlackTree {
    internal var root: Node? = null  // ‚ùå –ù–∞—Ä—É—à–∞–µ—Ç –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é
    internal fun balanceAfterInsert() // ‚ùå –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
}

// ‚ùå –ü–õ–û–•–û: –¢–µ—Å—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
@Test
fun testBalanceAfterInsertDirectly() {
    tree.root = Node(50, Color.BLACK)  // ‚ùå –î–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—è–º
    tree.balanceAfterInsert(node)      // ‚ùå –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥
}
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ?

1. **–•—Ä—É–ø–∫–∏–µ —Ç–µ—Å—Ç—ã** - –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç—ã —Å–ª–æ–º–∞—é—Ç—Å—è
2. **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ç–æ–¥—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á–∞—Å—Ç—å—é –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
3. **–¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è "–∫–∞–∫", –∞ –Ω–µ "—á—Ç–æ"** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –∞ –Ω–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
4. **–ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** - –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–µ–∑ –ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

### Black-Box Testing: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API

```kotlin
class RedBlackTree {
    private var root: Node? = null  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: private
    
    // ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π API
    fun insert(value: Int)
    fun delete(value: Int)
    fun search(value: Int): Boolean
    fun toList(): List<Int>
    fun isEmpty(): Boolean
    fun size(): Int
    
    // ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ - private
    private fun balanceAfterInsert(node: Node)
    private fun balanceAfterDelete(node: Node)
}
```

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

```kotlin
@Test
fun testComplexSequence() {
    // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–π API
    tree.insert(50)
    tree.insert(25)
    tree.insert(75)
    
    tree.delete(25)
    
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
    assertEquals(2, tree.size())
    assertFalse(tree.search(25))
    assertEquals(listOf(50, 75), tree.toList())
}

@Test
fun testBalancingThroughOperations() {
    // ‚úÖ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Å–≤–µ–Ω–Ω–æ —á–µ—Ä–µ–∑:
    // 1. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (toList() –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω)
    // 2. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π (search —Ä–∞–±–æ—Ç–∞–µ—Ç)
    
    val values = (1..100).toList()
    values.forEach { tree.insert(it) }
    
    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã - —ç—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É
    values.filter { it % 3 == 0 }.forEach { tree.delete(it) }
    
    val result = tree.toList()
    assertEquals(result.sorted(), result) // –î–µ—Ä–µ–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    
    // –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
    assertTrue(tree.search(1))
    assertFalse(tree.search(3))
}
```

## –ö–∞–∫ –¥–æ—Å—Ç–∏—á—å —Ö–æ—Ä–æ—à–µ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API?

### 1. –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

```kotlin
@Test
fun testAscendingInserts() {
    (1..10).forEach { tree.insert(it) }  // –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –≤–ª–µ–≤–æ
}

@Test
fun testDescendingInserts() {
    (10 downTo 1).forEach { tree.insert(it) }  // –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –≤–ø—Ä–∞–≤–æ
}
```

### 2. –°–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–¥–∞–ª–µ–Ω–∏—è

```kotlin
@Test
fun testLeftSideDeletions() {
    val values = (1..63).toList()
    values.forEach { tree.insert(it) }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ–≤–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –∑–µ—Ä–∫–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
    listOf(1, 2, 3, 4, 5).forEach { tree.delete(it) }
}

@Test
fun testRightSideDeletions() {
    // –£–¥–∞–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –¥—Ä—É–≥–∏–µ —Å–ª—É—á–∞–∏
    listOf(63, 62, 61, 60, 59).forEach { tree.delete(it) }
}
```

### 3. –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

```kotlin
@Test
fun testMixedOperations() {
    tree.insert(50)
    tree.insert(25)
    tree.insert(75)
    tree.delete(25)
    tree.insert(25)  // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞
    tree.delete(50)  // –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
    assertEquals(listOf(25, 75), tree.toList())
}
```

## –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º

**–¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- üìä –ü–æ–∫—Ä—ã—Ç–∏–µ: **84% –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, 68% –≤–µ—Ç–æ–∫**
- ‚úÖ –¢–µ—Å—Ç–æ–≤: **25**
- üìù –ö–æ–¥: **359 —Å—Ç—Ä–æ–∫**
- ‚ú® –í—Å–µ –º–µ—Ç–æ–¥—ã **private**
- ‚ú® –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–π API**

## –ü–æ—á–µ–º—É –Ω–µ 100% –ø–æ–∫—Ä—ã—Ç–∏—è?

–û—Å—Ç–∞–≤—à–∏–µ—Å—è 16% - —ç—Ç–æ **—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ —Ä–µ–¥–∫–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏** –≤ –º–µ—Ç–æ–¥–∞—Ö –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏:

1. –¢—Ä–µ–±—É—é—Ç 10+ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
2. –ó–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ü–≤–µ—Ç–æ–≤ —É–∑–ª–æ–≤
3. –í—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

**–í–∞–∂–Ω–æ:** 84% –ø–æ–∫—Ä—ã—Ç–∏—è —Å —á–µ—Ä–Ω—ã–º —è—â–∏–∫–æ–º - —ç—Ç–æ **–æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –¥–ª—è —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö!

## –í—ã–≤–æ–¥—ã

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
- –í—Å–µ –º–µ—Ç–æ–¥—ã private
- –¢–µ—Å—Ç—ã —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –¢–µ—Å—Ç—ã —É—Å—Ç–æ–π—á–∏–≤—ã –∫ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- internal/public –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- –î–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –ø–æ–ª—è–º
- –¢–µ—Å—Ç—ã –∑–Ω–∞—é—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## –ü—Ä–∏–Ω—Ü–∏–ø

> **"–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ü–û–í–ï–î–ï–ù–ò–ï, –∞ –Ω–µ –†–ï–ê–õ–ò–ó–ê–¶–ò–Æ"**

–ï—Å–ª–∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API, –≤–æ–∑–º–æ–∂–Ω–æ:
1. –≠—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ (—ç—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –¥–µ—Ç–∞–ª—å)
2. –≠—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –∫–æ—Å–≤–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. API –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–≥–∞—Ç (–Ω–æ —ç—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å)

**–î–ª—è Red-Black Tree:** –í—Å—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π `insert`, `delete`, `search` –∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç "–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å" —á–µ—Ä–µ–∑ `toList()`.
